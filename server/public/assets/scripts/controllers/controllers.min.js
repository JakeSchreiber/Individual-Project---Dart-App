/*! angular_routing_lecture_build 2015-12-05 */
myApp.controller("DartController",["$scope","$http",function(a,b){a.startNewGame=function(){a.myvalue=!1,a.showScoreboard=!0,a.selectedPlayer=!1,a.setPlayers()},a.setPlayers=function(){a.playerArray=[],a.chooseOpponent=!0,a.switchPlayerContainer=!0,a.getLoggedInPlayer=function(){b.get("/getloggedinplayer").then(function(b){a.loggedInPlayer=b.data,a.playerArray=a.loggedInPlayer,a.playerArray[0].roundArray=[],a.playerArray[0].dartArray=[]})},a.getLoggedInPlayer(),a.getAllUsers=function(){b.get("/getallplayers").then(function(b){a.allPlayers=b.data})},a.getAllUsers(),a.isSelectedPlayer=function(){return a.playerArray[1]=a.selectedPlayer,a.selectedPlayer}},a.setPlayers();var c=0;a.filterLimit=8,a.myvalue=!1,a.showScoreboard=!0,a.chooseWhoStarts=function(){c=0==c?1:0;var a=angular.element(document.querySelector(".team1Score"));a.toggleClass("active inactive");var b=angular.element(document.querySelector(".team2Score"));b.toggleClass("active inactive")},a.gameplay=function(){function d(){a.currentPlayer=a.playerArray[c]}a.chooseOpponent=!1,a.switchPlayerContainer=!1,d(),a.changeValue=function(d){function e(){var a=angular.element(document.querySelector(".team1Score"));a.toggleClass("active inactive");var b=angular.element(document.querySelector(".team2Score"));b.toggleClass("active inactive")}function f(){3==a.currentPlayer.dartArray.length&&(a.currentPlayer.roundScore=a.currentPlayer.dartArray[0]+a.currentPlayer.dartArray[1]+a.currentPlayer.dartArray[2]),2==a.currentPlayer.dartArray.length&&(a.currentPlayer.roundScore=a.currentPlayer.dartArray[0]+a.currentPlayer.dartArray[1]),1==a.currentPlayer.dartArray.length&&(a.currentPlayer.roundScore=a.currentPlayer.dartArray[0])}function g(){a.currentPlayer.roundScore=0,a.currentPlayer.dartsRemaining=3,a.currentPlayer.dartArray=[],a.dart1=0,a.dart2=0,a.dart3=0}function h(){if(0==a.currentPlayer.score&&(a.currentPlayer.wins++,a.playerArray[0].totalgames++,a.playerArray[1].totalgames++,alert("Game complete"),m(),j(),k(),o()),a.currentPlayer.score<0||1===a.currentPlayer.score){var b=c;f(),alert("BUST!"),a.playerArray[b].totalpointsscored-=a.currentPlayer.roundScore,a.playerArray[b].totaldartsthrown-=a.currentPlayer.dartArray.length,a.playerArray[b].score+=a.currentPlayer.roundScore,e(),g(),n()}}function i(){a.currentPlayer.ppd=parseFloat(a.currentPlayer.totalpointsscored/a.currentPlayer.totaldartsthrown).toFixed(2)}function j(){a.currentPlayer.roundAverage=parseFloat(a.currentPlayer.totalpointsscored/(a.currentPlayer.totaldartsthrown/3)).toFixed(2)}function k(){a.playerArray[0].averagedartspergame=parseFloat(a.playerArray[0].totaldartsthrown/a.playerArray[0].totalgames).toFixed(2),a.playerArray[1].averagedartspergame=parseFloat(a.playerArray[1].totaldartsthrown/a.playerArray[1].totalgames).toFixed(2)}function l(){25!==a.dart1&&50!==a.dart1||25!==a.dart2&&50!==a.dart2||25!==a.dart3&&50!==a.dart3||a.currentPlayer.hattricks++,50===a.dart1&&50===a.dart2&&50===a.dart3&&a.currentPlayer.deadeyes++}function m(){a.currentPlayer.roundScore>=100&&a.currentPlayer.roundScore<140&&a.currentPlayer._100++,a.currentPlayer.roundScore>=140&&a.currentPlayer.roundScore<180&&a.currentPlayer._140++,180==a.currentPlayer.roundScore&&a.currentPlayer._180++}function n(){var b=c+1;b<a.playerArray.length?(a.currentPlayer=a.playerArray[b],c++,a.gameplay()):(c=0,a.currentPlayer=a.playerArray[0],a.gameplay())}function o(){a.myvalue=!0,a.showScoreboard=!1}a.currentPlayer.dartArray.push(d),a.currentPlayer.score-=d,a.currentPlayer.scoreForAverage+=d,a.currentPlayer.totalpointsscored+=d,a.dart1=a.currentPlayer.dartArray[0],a.dart2=a.currentPlayer.dartArray[1],a.dart3=a.currentPlayer.dartArray[2],a.currentPlayer.dartsThrown++,a.currentPlayer.totaldartsthrown++,a.currentPlayer.dartsRemaining--,l(),h(),i(),0==a.currentPlayer.dartsRemaining&&(f(),confirm("Round Score: "+a.currentPlayer.roundScore+". Remove Darts")===!0?(a.currentPlayer.roundArray.push(a.currentPlayer.roundScore),m(),g(),n(),j(),e()):(a.currentPlayer.score+=a.currentPlayer.roundScore,a.currentPlayer.dartsThrown=a.currentPlayer.dartsThrown-3,a.currentPlayer.totalpointsscored-=a.currentPlayer.roundScore,a.currentPlayer.totaldartsthrown=a.currentPlayer.totaldartsthrown-3,g())),a.uploadPlayer1Stats=function(){b({url:"/updateplayer1stats",method:"POST",data:JSON.stringify({username:a.playerArray[0].username,_100:a.playerArray[0]._100,_140:a.playerArray[0]._140,_180:a.playerArray[0]._180,hattricks:a.playerArray[0].hattricks,deadeyes:a.playerArray[0].deadeyes,totalgames:a.playerArray[0].totalgames,wins:a.playerArray[0].wins,average:a.playerArray[0].roundAverage,ppd:a.playerArray[0].ppd,totaldartsthrown:a.playerArray[0].totaldartsthrown,totalpointsscored:a.playerArray[0].totalpointsscored,averagedartspergame:a.playerArray[0].averagedartspergame}),headers:{"Content-Type":"application/json"}}).success(function(b,c,d,e){a.users=b.users}).error(function(b,c,d,e){a.status=c+" "+d})},a.uploadPlayer2Stats=function(){b({url:"/updateplayer2stats",method:"POST",data:JSON.stringify({username:a.playerArray[1].username,_100:a.playerArray[1]._100,_140:a.playerArray[1]._140,_180:a.playerArray[1]._180,hattricks:a.playerArray[1].hattricks,deadeyes:a.playerArray[1].deadeyes,totalgames:a.playerArray[1].totalgames,wins:a.playerArray[1].wins,average:a.playerArray[1].roundAverage,ppd:a.playerArray[1].ppd,totaldartsthrown:a.playerArray[1].totaldartsthrown,totalpointsscored:a.playerArray[1].totalpointsscored,averagedartspergame:a.playerArray[1].averagedartspergame}),headers:{"Content-Type":"application/json"}}).success(function(b,c,d,e){a.users=b.users}).error(function(b,c,d,e){a.status=c+" "+d})}}}}]),myApp.controller("ProfileController",["$scope","$http",function(a,b){a.getProfileInfo=function(){b.get("/getprofile").then(function(a){return c(a)})};var c=function(c){0===c.data.length?b.post("/createuser").then(function(b){a.profileInfo=b.data}):a.profileInfo=c.data};a.getProfileInfo()}]),myApp.controller("StatsController",["$scope","$http",function(a,b){a.getStats=function(){b.get("/stats").then(function(b){a.stats=b.data})},a.getStats()}]);